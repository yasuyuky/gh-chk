fragment PrFields on PullRequest {
  repository {
    name
    owner {
      login
    }
  }
  id
  number
  title
  url
  createdAt
  mergeStateStatus
  reviewDecision
  commits(last: 1) {
    nodes {
      commit {
        statusCheckRollup {
          state
        }
      }
    }
  }
  reviewRequests(first: 10) {
    nodes {
      requestedReviewer {
        ... on User {
          login
        }
        ... on Team {
          name
        }
      }
    }
  }
}

query SearchPrs($query: String!, $after: String) {
  search(type: ISSUE, query: $query, first: 100, after: $after) {
    nodes {
      ... on PullRequest {
        ...PrFields
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
}

query GetPrBody($login: String!, $name: String!, $number: Int!) {
  repositoryOwner(login: $login) {
    repository(name: $name) {
      pullRequest(number: $number) {
        bodyText
      }
    }
  }
}

mutation MergePullRequest($pullRequestId: ID!) {
  mergePullRequest(input: { pullRequestId: $pullRequestId }) {
    clientMutationId
  }
}

mutation ApprovePullRequest($pullRequestId: ID!) {
  addPullRequestReview(
    input: { pullRequestId: $pullRequestId, event: APPROVE }
  ) {
    clientMutationId
  }
}
